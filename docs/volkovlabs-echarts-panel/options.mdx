---
tags:
  - Apache ECharts
  - JavaScript Code
---

import Image from "@theme/Image";
import Video from "@theme/Video";

# setOption() function

`setOption(options)` is the main Apache ECharts library function. This function is called to build any chart. It has one mandatory parameter - `options` which is a chart configuration in a JSON format.

<Image
  title="setOptions Schema."
  src="/img/plugins/volkovlabs-echarts-panel/schema.png"
/>

You specify the `options` in the Apache ECharts visualization panel in the Monaco Code editor located on the right-hand side.

<Image
  title="setOptions Function."
  src="/img/plugins/volkovlabs-echarts-panel/function.png"
/>

This whole text area is basically a body of the function that you write for the execution. This function takes in many parameters from Grafana. See the complete list in the table below.

The only parameter that is passed from this function to the `setOption()` is `options`. See the 'return' statement in the picture above.

## Parameters

| Parameter                                  | Description                                                                                                                                                                                             |
| ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `data`                                     | Grafana's `data` object with time range, series and request information. See the example on the picture above.                                                                                          |
| `echarts`                                  | ECharts library.                                                                                                                                                                                        |
| `echartsInstance`                          | Instance of the ECharts. See the example on the picture above. To learn more about [echartsInstance](https://echarts.apache.org/en/api.html#echartsInstance) take a look at the official documentation. |
| `ecStat`                                   | A statistical and data mining tool for Apache ECharts. More information in the [ecStat](/plugins/volkovlabs-echarts-panel/tutorials/ecstat) section.                                                    |
| `eventBus`                                 | Grafana's `eventBus` to publish and subsribe to application events.                                                                                                                                     |
| `locationService`                          | Grafana's `locationService` to work with browser location and history.                                                                                                                                  |
| `notifyError(['Header', 'Error Message'])` | Display error notification.                                                                                                                                                                             |
| `notifySuccess(['Header', 'Message'])`     | Display successful notification.                                                                                                                                                                        |
| `replaceVariables`                         | The `replaceVariables()` function to interpolate variables.                                                                                                                                             |
| `theme`                                    | Grafana's `theme` object.                                                                                                                                                                               |

To learn more about parameters, you can log them in the Browser Console:

```javascript
console.log(
  data,
  theme,
  echartsInstance,
  echarts,
  replaceVariables,
  locationService
);
```

## Notifications

Success and Error notifications can be triggered on events handling:

```javascript
notifySuccess(["Update", "Values updated successfully."]);
notifyError(["Update", `An error occured updating values.`]);
```

## Scale when resizing

To scale the content when panel is resized use `echartsInstance` methods to retrieve the width and height of the panel.

```javascript
  graphic: {
    type: "image",
    style: {
      image: `data:image/svg+xml;utf8,${SVG}`,
      width: echartsInstance.getWidth(),
      height: echartsInstance.getHeight(),
    },
  },
```

To learn more about [echartsInstance](https://echarts.apache.org/en/api.html#echartsInstance) take a look at the official documentation.

## Create DOM (Document Object Model) Elements

It's possible to add elements (button, checkbox, select, etc.) to the DOM (Document Object Model) using `echartsInstance`. For example, you can add a button with an event handler.

```javascript
const myFunction = () => {
  alert("myFunction() called!");
};

//Get the DOM for the panel
let dom = echartsInstance.getDom();

//Get the child nodes
let nodeList = dom.childNodes;

//If we haven't added our controls to the DOM yet
if (nodeList.length < 2) {
  //Create a new button
  const btn = document.createElement("button");

  //Establish button name
  const textnode = document.createTextNode("My Button");
  btn.appendChild(textnode);

  //Add click event handler
  btn.addEventListener("click", myFunction);

  //Create a new <div>
  const div = document.createElement("div");

  //Add button to <div>
  div.appendChild(btn);

  //Insert new <div> ahead of existing chart div
  dom.insertBefore(div, dom.firstChild);
}
```
