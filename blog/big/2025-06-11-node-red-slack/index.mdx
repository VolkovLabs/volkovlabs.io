---
authors: [mikhail, alex]
slug: node-red-slack/
tags: [Business Intelligence]
image: /img/blog/2025-06-11-node-red-slack/banner.png
keywords: [Business Intelligence, Alerting, Grafana, Workflow, Automation]
---

import Code from "@theme/Code";
import Feedback from "@site/big/_feedback.mdx";
import GettingStarted from "@site/big/_getting_started.mdx";
import Image from "@theme/Image";
import Shorts from "@theme/Shorts";
import Youtube from "@theme/Youtube";

# Business Intelligence: Sending Slack Alerts with Node-RED

At Volkov Labs, we're passionate about creating seamless integrations for Business Intelligence workflows. One of our recent projects demonstrates how to use **Node-RED** to send alerts to **Slack** by leveraging dashboard variables from **Grafana**. This powerful combination allows businesses to monitor critical metrics in real-time and receive instant notifications in their communication channels.

In this blog post, we'll walk you through the Node-RED workflow we've developed to send text messages and images (like panel screenshots) to Slack, ensuring your team stays informed about important events and alerts.

## Why Node-RED, Grafana, and Slack?

- **Node-RED**: A low-code programming tool for wiring together hardware devices, APIs, and online services. It’s perfect for creating custom workflows and automating tasks.
- **Grafana**: A leading platform for monitoring and observability, Grafana allows you to visualize data and set up alerts based on dashboard variables.
- **Slack**: A widely-used communication tool for teams, Slack provides a centralized place to receive notifications and collaborate.

By integrating these tools, you can create a robust alerting system that bridges the gap between data visualization and team communication. Whether it's a critical system outage or a performance metric crossing a threshold, your team will be notified instantly in Slack.

## Project Overview

Our Node-RED flow is designed to handle incoming HTTP POST requests from Grafana alerts, process the payload (including dashboard variables), and send formatted messages or images to a specified Slack channel. The flow supports two primary use cases:

1. Sending simple text messages to Slack.
2. Sending images (e.g., panel screenshots from Grafana) along with a message.

The workflow also includes error handling, debugging nodes for troubleshooting, and HTTP responses to confirm the success or failure of the operation.

<Image
  title="Slack Message for High Latency in Business Engines."
  src="/img/blog/2025-06-11-node-red-slack/slack-message.png"
/>

### Key Features

- **HTTP Endpoint**: Receives alert data from Grafana via a POST request to `/slack`.
- **Payload Processing**: Extracts relevant information, such as channel ID, message text, and optional image data (e.g., panel screenshots).
- **Conditional Logic**: Checks if an image is included in the payload and routes the flow accordingly.
- **Slack API Integration**: Uses Slack’s API to send messages (`chat.postMessage`), get upload URLs for images (`files.getUploadURLExternal`), upload files, and complete the upload process (`files.completeUploadExternal`).
- **Error Handling**: Catches and logs errors, ensuring the system remains robust even if something goes wrong.
- **Debugging**: Multiple debug nodes to inspect payloads, headers, and API responses during development.

<Image
  title="Node-RED End to End Workflow."
  src="/img/blog/2025-06-11-node-red-slack/workflow.png"
/>

## Node-RED Workflow Breakdown

Let’s dive into the key components of the Node-RED flow, which is defined in the `slack.json` configuration file. Below is a high-level explanation of the flow’s structure and logic.

### Triggering the Flow

The flow starts with an **HTTP In** node (`Slack Trigger /slack`) that listens for POST requests at the `/slack` endpoint. This node receives alert data from Grafana, including dashboard variables like the Slack channel ID, message text, and optional image data.

- **Input**: HTTP POST request with a JSON payload.
- **Output**: Routes the message to debug nodes (`Show Payload`, `Show Headers`) and a processing node (`Prepare Payload`).

<Image
  title="From triggering the Flow to Check image Switch."
  src="/img/blog/2025-06-11-node-red-slack/switch-workflow.png"
/>

### Preparing the Payload

The **Prepare Payload** function node extracts relevant data from the incoming request and formats it for Slack. It retrieves:

- The Slack channel ID from the request headers.
- The alert message text.
- Optional image data (e.g., a panel screenshot) and a title for the image.

This node constructs a new `msg.payload` object with the necessary fields and passes it to the next stage.

```js
/**
 * Panel Screenshot
 */
let image = msg.payload.event.condition?.panelScreenshot || "";
let title = msg.payload.event.alert?.title || "Screenshot";

/**
 * Payload
 */
msg.payload = {
  channel_id: msg.req.headers.channel_id,
  text: msg.payload.message,
  title,
  image,
};

return msg;
```

### Checking for Images

A **Switch** node (`Check Image`) checks if an image is included in the payload by evaluating `msg.payload.image`. The flow splits into two paths:

- **Image Present**: Routes to nodes for uploading the image to Slack.
- **No Image**: Routes to nodes for sending a simple text message.

### Sending Text Messages

If no image is present, the **Set Message** function node formats the payload for Slack’s `chat.postMessage` API endpoint. The formatted payload includes the channel ID and the text message.

- **HTTP Request Node (`Send to Slack`)**: Sends the payload to Slack using a POST request.
- **Response Handling**: The response is passed to a function node (`Response Status`) to set the HTTP status code (200 for success, 400 for failure) and then to an **HTTP Response** node to return the result to the caller.

```js
/**
 * Payload
 */
msg.payload = {
  channel: msg.payload.channel_id,
  text: msg.payload.text,
};

return msg;
```

### Uploading Images to Slack

If an image is present, the flow processes it through a series of steps:

1. **Set Upload URL Payload**: Converts the Base64-encoded image (e.g., a Grafana panel screenshot) to a Buffer and prepares metadata like filename, file length, and type (PNG).
2. **Get Upload URL**: Uses Slack’s `files.getUploadURLExternal` API to retrieve a temporary upload URL for the image.
3. **Set Upload File Payload**: Formats the payload for the upload request using the retrieved URL.
4. **Upload File to URL**: Sends the image data to the temporary URL via a POST request.
5. **Set Complete Payload**: Prepares the final payload for completing the upload, including the file ID, channel ID, and an initial comment (message text).
6. **Complete Upload**: Calls Slack’s `files.completeUploadExternal` API to finalize the upload and share the image in the specified channel.

After the upload is complete, the response is routed to the `Response Status` node and returned via the `HTTP Response` node.

<Image
  title="Uploading images to Slack workflow."
  src="/img/blog/2025-06-11-node-red-slack/upload-workflow.png"
/>

### Error Handling and Debugging

- A **Catch** node (`Error Catch`) captures any errors that occur during the flow execution and routes them to an error-specific HTTP response node (`Error Response`) with a 400 status code.
- Multiple **Debug** nodes are included throughout the flow to log payloads, headers, and API responses. These are invaluable for troubleshooting and ensuring the flow operates as expected.

### Testing the Flow

The flow includes two **Inject** nodes for testing:

- **Send Message**: Simulates sending a simple text message to Slack.
- **Send Image**: Simulates sending a message with an image (Base64-encoded data).

These nodes allow developers to test the flow without needing to trigger real alerts from Business Intelligence.

## Setting Up the Integration

To replicate this workflow in your environment, follow these steps:

1. **Install Node-RED**: If you don’t already have Node-RED installed, start using our [Docker Compose configuration](https://github.com/VolkovLabs/business-intelligence/blob/main/docker-compose.yml) or follow the official [installation guide](https://nodered.org/docs/getting-started/).
2. **Import the Flow**: Copy the JSON configuration from [`slack.json`](https://github.com/VolkovLabs/business-intelligence/blob/main/node-red/slack.json) and import it into Node-RED.
3. **Configure Slack API Token**: Update the HTTP Request nodes with your Slack Bot User OAuth Token for authentication.

   - **Send to Slack**: description,
   - **Get Upload URL**: description,
   - **Complete Upload**: description,
   - **Upload File to URL**: description

4. **Set Up Grafana Alerts**: Configure action in Business Engine to send alert notifications to the Node-RED HTTP endpoint (`/slack`) using a webhook. Include relevant dashboard variables like `channel_id`, `message`.
5. **Deploy and Test**: Deploy the flow in Node-RED and use the `Inject` nodes to test sending messages and images to Slack.

## Conclusion

This Node-RED workflow demonstrates the power of integrating Business Intelligence with Slack for real-time alerting using dashboard variables in Grafana. By leveraging dashboard variables from Grafana, you can send customized notifications—complete with text and images—to keep your team informed and responsive.

At Volkov Labs, we’re committed to building solutions that streamline workflows and enhance data-driven decision-making. Business Intelligence platform is in active development with the latest release 3.4.0 available to try with Community license.

Stay tuned for more updates and tutorials on Business Intelligence, Grafana, and Node-RED!

<GettingStarted />

<Feedback />
